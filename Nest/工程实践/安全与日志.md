# 安全与日志

# 系统安全

## Helmet

Helmet 可以通过适当设置 HTTP 标头来帮助保护您的应用程序免受某些知名的网络漏洞的侵害。通常，Helmet 只是 12 个较小的中间件功能的集合，这些功能设置了与安全性相关的 HTTP 响应头。首先，安装所需的软件包：

```sh
$ npm i --save helmet

import * as helmet from 'helmet';
// somewhere in your initialization file
app.use(helmet());
```

## CORS

跨域资源共享（CORS）是一种允许从另一个域请求资源的机制。在底层，Nest 利用了 cors 软件包，该软件包提供了许多选项，您可以根据自己的需求进行自定义。为了启用 CORS，您必须调用 enableCors()方法。

```ts
const app = await NestFactory.create(ApplicationModule);
app.enableCors();
await app.listen(3000);

const app = await NestFactory.create(ApplicationModule, { cors: true });
await app.listen(3000);
```

## CSRF

跨站点请求伪造（称为 CSRF 或 XSRF）是一种网站的恶意利用，其中从 Web 应用程序信任的用户发送未经授权的命令。为了减轻这种攻击，您可以使用 csurf 软件包。首先，安装所需的软件包：

```sh
$ npm i --save csurf

import * as csurf from 'csurf';
// somewhere in your initialization file
app.use(csurf());

```

## Rate limiting

为了保护您的应用程序免受暴力攻击，您必须实施某种速率限制。幸运的是，NPM 上已经有很多中间件可用。其中之一是 express-rate-limit。

```ts
import * as rateLimit from "express-rate-limit";
// somewhere in your initialization file
app.use(
  rateLimit({
    windowMs: 15 * 60 * 1000, // 15 minutes
    max: 100 // limit each IP to 100 requests per windowMs
  })
);
```

# 日志
